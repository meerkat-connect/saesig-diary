<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{layout/main}">
<div layout:fragment="content">
    <div class="col-12 m-b-20">
        <div class="ss-sub-header">
            <div class="ss-segmeneted-control ss-segmeneted-control--active" data-periodType="daily">일간</div>
            <div class="ss-segmeneted-control" data-periodType="weekly">주간</div>
            <div class="ss-segmeneted-control" data-periodType="monthly">월간</div>
            <div class="ss-segmeneted-control" data-periodType="totally">종합</div>
        </div>`
    </div>

    <div id="dashboardArea">
    </div>

    <script type="text/javascript" th:src="@{/files/bower_components/chart.js/dist/Chart.js}"></script>
    <script th:inline="javascript">
        $(function () {
            const initParam = {
                periodType : 'daily'
                , searchAdoptionYear : new Date().getFullYear()
                , searchAdoptionMonth : 1
                , searchAdoptionStatus : 'ONGOING'
            }

            getDashboardData(initParam);

            $('.ss-segmeneted-control').on('click', function () {
                let data = $(this).data('periodtype');
                initParam.periodType = data;
                getDashboardData(initParam)
                $('.ss-segmeneted-control').removeClass('ss-segmeneted-control--active')
                $(this).addClass('ss-segmeneted-control--active');
            })

        });

        const getDashboardData = (param) => {
            $.ajax({
                url: '/admin/dashboard'
                , dataType: 'html'
                , data: param
                , type: 'get'
            }).done(function(result) {
                $('#dashboardArea').html(result);
            }).fail(function(result) {
                if(result.status === 0) {
                    alert("알 수 없는 에러가 발생하였습니다.");
                } else{
                    alert('데이터 조회에 실패하였습니다.');
                }
            })
        }
    </script>

</div>


</html>
